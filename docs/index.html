<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è£œåŠ©é‡‘ãƒ»åŠ©æˆé‡‘ æƒ…å ±ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --ink:#0f1923;--ink-light:#3d4f5c;--ink-muted:#7a8fa0;--surface:#f5f7fa;
  --card:#ffffff;--border:#dde4ec;--accent:#0057ff;--accent-2:#00c48c;
  --warn:#ff6b35;--local-bg:#fffbf0;--local-border:#f0a500;
  --radius:10px;--shadow:0 2px 12px rgba(0,0,0,.07);--shadow-lg:0 8px 32px rgba(0,0,0,.12);
}
body{font-family:'Noto Sans JP',sans-serif;background:var(--surface);color:var(--ink);min-height:100vh;font-size:14px;line-height:1.6;}
.site-header{background:var(--ink);color:#fff;padding:0 32px;display:flex;align-items:center;justify-content:space-between;height:60px;position:sticky;top:0;z-index:100;box-shadow:0 2px 16px rgba(0,0,0,.3);}
.site-header .logo{font-size:1rem;font-weight:700;letter-spacing:.04em;display:flex;align-items:center;gap:10px;}
.site-header .logo .dot{width:8px;height:8px;background:var(--accent);border-radius:50%;animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1);}50%{opacity:.5;transform:scale(1.4);}}
.header-meta{font-size:.78rem;color:rgba(255,255,255,.55);font-family:'DM Mono',monospace;}
.hero{background:linear-gradient(135deg,#0f1923 0%,#1a2e45 50%,#0f3460 100%);color:#fff;padding:48px 32px 40px;position:relative;overflow:hidden;}
.hero::before{content:'';position:absolute;inset:0;background:repeating-linear-gradient(45deg,transparent,transparent 40px,rgba(255,255,255,.015) 40px,rgba(255,255,255,.015) 41px);}
.hero-inner{position:relative;max-width:1200px;margin:0 auto;}
.hero h1{font-size:clamp(1.4rem,3vw,2rem);font-weight:900;line-height:1.3;margin-bottom:10px;}
.hero h1 span{color:#4da3ff;}
.hero p{color:rgba(255,255,255,.65);font-size:.92rem;max-width:520px;}
.hero-stats{display:flex;gap:24px;margin-top:28px;flex-wrap:wrap;}
.hero-stat{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);border-radius:var(--radius);padding:14px 20px;min-width:130px;}
.hero-stat .num{font-size:1.8rem;font-weight:900;font-family:'DM Mono',monospace;line-height:1;}
.hero-stat .num.accent{color:#4da3ff;}.hero-stat .num.accent2{color:#00e0a0;}.hero-stat .num.warn{color:#ffa040;}
.hero-stat .label{font-size:.75rem;color:rgba(255,255,255,.55);margin-top:4px;}
.alert-bar{background:#fff8e6;border-bottom:2px solid var(--local-border);padding:10px 32px;font-size:.83rem;color:#7a4f00;display:flex;align-items:center;gap:8px;}
.main{max-width:1320px;margin:0 auto;padding:28px 24px 60px;}
.controls{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px 20px;margin-bottom:20px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:14px;}
.search-wrap{display:flex;align-items:center;gap:10px;background:var(--surface);border:1.5px solid var(--border);border-radius:8px;padding:8px 14px;transition:border-color .2s;}
.search-wrap:focus-within{border-color:var(--accent);}
.search-wrap input{border:none;background:transparent;outline:none;font-size:.92rem;font-family:'Noto Sans JP',sans-serif;width:100%;color:var(--ink);}
.filter-row{display:flex;flex-direction:column;gap:8px;}
.filter-label{font-size:.72rem;font-weight:700;color:var(--ink-muted);letter-spacing:.06em;text-transform:uppercase;}
.chips{display:flex;flex-wrap:wrap;gap:6px;}
.chip{background:var(--surface);border:1.5px solid var(--border);border-radius:20px;padding:4px 12px;font-size:.78rem;cursor:pointer;transition:all .15s;color:var(--ink-light);white-space:nowrap;user-select:none;}
.chip:hover{border-color:var(--accent);color:var(--accent);}
.chip.active{background:var(--accent);border-color:var(--accent);color:#fff;font-weight:700;}
.chip .badge{background:rgba(255,255,255,.25);border-radius:10px;padding:0 6px;font-size:.7rem;margin-left:3px;}
.section{margin-bottom:32px;}
.section-head{display:flex;align-items:center;gap:10px;margin-bottom:12px;}
.section-head .bar{width:4px;height:22px;border-radius:2px;background:var(--local-border);flex-shrink:0;}
.section-head .bar.national{background:var(--accent);}
.section-head h2{font-size:1rem;font-weight:700;color:var(--ink);}
.section-head .count{margin-left:auto;font-size:.78rem;color:var(--ink-muted);font-family:'DM Mono',monospace;}
.card-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:14px;}
.card{background:var(--card);border:1.5px solid var(--border);border-radius:var(--radius);padding:16px 18px;box-shadow:var(--shadow);transition:transform .15s,box-shadow .15s,border-color .15s;display:flex;flex-direction:column;gap:10px;animation:fadeUp .3s ease both;}
.card:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg);border-color:#b0c4e0;}
.card.local{border-color:var(--local-border);background:var(--local-bg);}
.card.local:hover{border-color:#d4890a;}
.card.hidden{display:none;}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}
.card-top{display:flex;align-items:flex-start;justify-content:space-between;gap:8px;}
.card-title{font-size:.9rem;font-weight:700;line-height:1.45;color:var(--ink);flex:1;}
.card-title a{color:inherit;text-decoration:none;transition:color .15s;}
.card-title a:hover{color:var(--accent);}
.new-badge{background:var(--warn);color:#fff;font-size:.65rem;font-weight:700;padding:2px 7px;border-radius:4px;white-space:nowrap;flex-shrink:0;}
.local-badge{background:var(--local-border);color:#fff;font-size:.65rem;font-weight:700;padding:2px 7px;border-radius:4px;white-space:nowrap;flex-shrink:0;}
.card-meta{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.meta-item{display:flex;flex-direction:column;gap:2px;}
.meta-label{font-size:.65rem;font-weight:700;color:var(--ink-muted);letter-spacing:.05em;text-transform:uppercase;}
.meta-value{font-size:.8rem;color:var(--ink-light);line-height:1.4;}
.meta-value.amount{color:#1a7a50;font-weight:700;}.meta-value.deadline{color:#c04a00;font-weight:600;}.meta-value.empty{color:var(--ink-muted);}
.card-footer{display:flex;align-items:center;justify-content:space-between;padding-top:8px;border-top:1px solid var(--border);gap:6px;flex-wrap:wrap;}
.cat-tag{font-size:.72rem;padding:3px 9px;border-radius:12px;background:#ebf3ff;color:var(--accent);font-weight:600;white-space:nowrap;}
.cat-tag.local{background:#fff3d6;color:#a06000;}
.region-tag{font-size:.72rem;color:var(--ink-muted);}
.apply-btn{font-size:.75rem;font-weight:700;color:var(--accent);text-decoration:none;padding:4px 10px;border:1.5px solid var(--accent);border-radius:6px;transition:all .15s;margin-left:auto;white-space:nowrap;}
.apply-btn:hover{background:var(--accent);color:#fff;}
.empty-state{text-align:center;padding:48px 20px;color:var(--ink-muted);grid-column:1/-1;}
.empty-state .emoji{font-size:2.5rem;display:block;margin-bottom:10px;}
.site-footer{background:var(--ink);color:rgba(255,255,255,.4);text-align:center;padding:20px;font-size:.75rem;}
#loading{position:fixed;inset:0;background:var(--ink);display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;z-index:9999;transition:opacity .4s;}
#loading.fade{opacity:0;pointer-events:none;}
.loader{width:40px;height:40px;border:3px solid rgba(255,255,255,.2);border-top-color:var(--accent);border-radius:50%;animation:spin .8s linear infinite;margin-bottom:16px;}
@keyframes spin{to{transform:rotate(360deg);}}
#loading p{font-size:.85rem;color:rgba(255,255,255,.5);}
@media(max-width:640px){.hero,.main{padding-left:16px;padding-right:16px;}.site-header{padding:0 16px;}.alert-bar{padding:10px 16px;}.card-meta{grid-template-columns:1fr;}}
</style>
</head>
<body>
<div id="loading"><div class="loader"></div><p>è£œåŠ©é‡‘æƒ…å ±ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™â€¦</p></div>
<header class="site-header">
  <div class="logo"><div class="dot"></div>è£œåŠ©é‡‘ãƒ»åŠ©æˆé‡‘ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</div>
  <div class="header-meta" id="headerMeta">èª­ã¿è¾¼ã¿ä¸­â€¦</div>
</header>
<section class="hero">
  <div class="hero-inner">
    <h1>ä¸­å°ä¼æ¥­å‘ã‘<br><span>è£œåŠ©é‡‘ãƒ»åŠ©æˆé‡‘</span> æƒ…å ±ä¸€è¦§</h1>
    <p>å›½ãƒ»çœåºã‹ã‚‰å„éƒ½é“åºœçœŒã®è‡ªæ²»ä½“æƒ…å ±ã¾ã§ã€æ¯æ—¥è‡ªå‹•åé›†ã€‚è¦‹é€ƒã—ã‚„ã™ã„ãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã‚’å«ã‚ã¦ä¸€è¦§ã§ç¢ºèªã§ãã¾ã™ã€‚</p>
    <div class="hero-stats">
      <div class="hero-stat"><div class="num accent" id="statToday">â€”</div><div class="label">æœ¬æ—¥ã®æƒ…å ±ä»¶æ•°</div></div>
      <div class="hero-stat"><div class="num warn" id="statLocal">â€”</div><div class="label">ğŸ“ è‡ªæ²»ä½“æƒ…å ±ï¼ˆè¦ç¢ºèªï¼‰</div></div>
      <div class="hero-stat"><div class="num accent2" id="statTotal">â€”</div><div class="label">ç´¯è¨ˆåé›†ä»¶æ•°</div></div>
      <div class="hero-stat"><div class="num" id="statUpdated" style="font-size:1rem;padding-top:4px">â€”</div><div class="label">æœ€çµ‚æ›´æ–°</div></div>
    </div>
  </div>
</section>
<div class="alert-bar"><span>âš ï¸</span><strong>é»„è‰²ã‚«ãƒ¼ãƒ‰ï¼ˆè‡ªæ²»ä½“æƒ…å ±ï¼‰</strong>ã¯ç”³è«‹æœŸé™ãŒçŸ­ã„ã‚‚ã®ãŒå¤šã„ãŸã‚å„ªå…ˆç¢ºèªã‚’æ¨å¥¨ã€‚å†…å®¹ã¯å‚è€ƒæƒ…å ±ã®ãŸã‚ã€å¿…ãšå…¬å¼ã‚µã‚¤ãƒˆã§ã”ç¢ºèªãã ã•ã„ã€‚</div>
<main class="main">
  <div class="controls">
    <div class="search-wrap"><span>ğŸ”</span><input type="text" id="searchInput" placeholder="è£œåŠ©é‡‘åãƒ»æ©Ÿé–¢åãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢â€¦" autocomplete="off"></div>
    <div class="filter-row"><div class="filter-label">ã‚«ãƒ†ã‚´ãƒª</div><div class="chips" id="catChips"></div></div>
    <div class="filter-row"><div class="filter-label">å¯¾è±¡åœ°åŸŸ</div><div class="chips" id="prefChips"></div></div>
    <div class="filter-row"><div class="filter-label">æƒ…å ±ã‚½ãƒ¼ã‚¹</div><div class="chips" id="sourceChips">
      <span class="chip active" onclick="setFilter('source','all',this)">ã™ã¹ã¦</span>
      <span class="chip" onclick="setFilter('source','è‡ªæ²»ä½“',this)">ğŸ“ è‡ªæ²»ä½“ã®ã¿</span>
      <span class="chip" onclick="setFilter('source','å›½ãƒ»çœåº',this)">ğŸ›ï¸ å›½ãƒ»çœåºã®ã¿</span>
    </div></div>
  </div>
  <div class="section">
    <div class="section-head"><div class="bar"></div><h2>ğŸ“ è‡ªæ²»ä½“æƒ…å ±ï¼ˆè¦‹é€ƒã—ã‚„ã™ã„ãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ï¼‰</h2><span class="count" id="localCount"></span></div>
    <div class="card-grid" id="localGrid"><div class="empty-state"><span class="emoji">â³</span>èª­ã¿è¾¼ã¿ä¸­â€¦</div></div>
  </div>
  <div class="section">
    <div class="section-head"><div class="bar national"></div><h2>ğŸ›ï¸ å›½ãƒ»çœåºæƒ…å ±</h2><span class="count" id="nationalCount"></span></div>
    <div class="card-grid" id="nationalGrid"><div class="empty-state"><span class="emoji">â³</span>èª­ã¿è¾¼ã¿ä¸­â€¦</div></div>
  </div>
</main>
<footer class="site-footer">æ¯æ—¥ 09:00 è‡ªå‹•æ›´æ–° ï½œ ãƒ‡ãƒ¼ã‚¿ã¯å‚è€ƒæƒ…å ±ã§ã™ã€‚ç”³è«‹ã¯å¿…ãšå…¬å¼ãƒšãƒ¼ã‚¸ã§ã”ç¢ºèªãã ã•ã„ã€‚</footer>
<script>
const state={items:[],filters:{cat:'all',pref:'all',source:'all',q:''}};
const TODAY=new Date().toISOString().slice(0,10);
async function loadData(){
  try{
    const res=await fetch('data.json?v='+Date.now());
    const json=await res.json();
    state.items=json.items||[];
    const todayItems=state.items.filter(d=>d.date===TODAY);
    const localItems=todayItems.filter(d=>d.source==='è‡ªæ²»ä½“');
    document.getElementById('statToday').textContent=todayItems.length;
    document.getElementById('statLocal').textContent=localItems.length;
    document.getElementById('statTotal').textContent=json.total||state.items.length;
    document.getElementById('statUpdated').textContent=json.updated||'â€”';
    document.getElementById('headerMeta').textContent='æœ€çµ‚æ›´æ–°: '+(json.updated||'â€”');
    buildFilters();render();
  }catch(e){
    document.getElementById('localGrid').innerHTML='<div class="empty-state"><span class="emoji">âš ï¸</span>ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å¤±æ•—ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚</div>';
    document.getElementById('nationalGrid').innerHTML='';
  }finally{
    const el=document.getElementById('loading');
    el.classList.add('fade');setTimeout(()=>el.remove(),500);
  }
}
function buildFilters(){
  const cats=['all',...new Set(state.items.map(d=>d.category).filter(Boolean))];
  const prefs=['all','å…¨å›½',...new Set(state.items.map(d=>d.pref).filter(p=>p&&p!=='å…¨å›½'))];
  const catCounts=countBy(state.items,'category');
  const prefCounts=countBy(state.items,'pref');
  renderChips('catChips',cats,catCounts,'cat',c=>c==='all'?'ã™ã¹ã¦':c);
  renderChips('prefChips',prefs,prefCounts,'pref',p=>p==='all'?'ã™ã¹ã¦ã®åœ°åŸŸ':p);
}
function countBy(arr,key){return arr.reduce((acc,item)=>{acc[item[key]]=(acc[item[key]]||0)+1;return acc;},{});}
function renderChips(id,values,counts,type,labelFn){
  document.getElementById(id).innerHTML=values.map(v=>{
    const cnt=v==='all'?'':'<span class="badge">'+(counts[v]||0)+'</span>';
    const active=state.filters[type]===v?' active':'';
    return '<span class="chip'+active+'" onclick="setFilter(\''+type+'\',\''+v+'\',this)">'+labelFn(v)+cnt+'</span>';
  }).join('');
}
function setFilter(type,value,el){
  state.filters[type]=value;
  const pid=type==='cat'?'catChips':type==='pref'?'prefChips':'sourceChips';
  document.querySelectorAll('#'+pid+' .chip').forEach(c=>c.classList.remove('active'));
  el.classList.add('active');render();
}
document.getElementById('searchInput').addEventListener('input',e=>{state.filters.q=e.target.value.toLowerCase();render();});
function matchItem(item){
  const{cat,pref,source,q}=state.filters;
  if(cat!=='all'&&item.category!==cat)return false;
  if(pref!=='all'&&item.pref!==pref)return false;
  if(source!=='all'&&item.source!==source)return false;
  if(q&&![item.title,item.org,item.target,item.category].some(s=>s&&s.toLowerCase().includes(q)))return false;
  return true;
}
function render(){
  const filtered=state.items.filter(matchItem);
  const local=filtered.filter(d=>d.source==='è‡ªæ²»ä½“');
  const national=filtered.filter(d=>d.source!=='è‡ªæ²»ä½“');
  document.getElementById('localCount').textContent=local.length+'ä»¶';
  document.getElementById('nationalCount').textContent=national.length+'ä»¶';
  document.getElementById('localGrid').innerHTML=local.length?local.map(cardHTML).join(''):'<div class="empty-state"><span class="emoji">ğŸ”</span>è©²å½“ã™ã‚‹æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“</div>';
  document.getElementById('nationalGrid').innerHTML=national.length?national.map(cardHTML).join(''):'<div class="empty-state"><span class="emoji">ğŸ”</span>è©²å½“ã™ã‚‹æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“</div>';
}
function cardHTML(item){
  const isLocal=item.source==='è‡ªæ²»ä½“';
  const isNew=item.date===TODAY;
  const amt=item.amount?'<span class="meta-value amount">'+esc(item.amount)+'</span>':'<span class="meta-value empty">â€”</span>';
  const ddl=item.deadline?'<span class="meta-value deadline">'+esc(item.deadline)+'</span>':'<span class="meta-value empty">â€”</span>';
  const tgt=item.target?'<span class="meta-value">'+esc(item.target.slice(0,60))+(item.target.length>60?'â€¦':'')+'</span>':'<span class="meta-value empty">ä¸­å°ä¼æ¥­ãƒ»äº‹æ¥­è€…</span>';
  return '<div class="card'+(isLocal?' local':'')+'"><div class="card-top"><div class="card-title"><a href="'+esc(item.url)+'" target="_blank" rel="noopener">'+esc(item.title)+'</a></div><div style="display:flex;gap:4px">'+(isNew?'<span class="new-badge">NEW</span>':'')+(isLocal?'<span class="local-badge">è‡ªæ²»ä½“</span>':'')+'</div></div><div class="card-meta"><div class="meta-item"><span class="meta-label">å®Ÿæ–½æ©Ÿé–¢</span><span class="meta-value">'+esc(item.org)+'</span></div><div class="meta-item"><span class="meta-label">è£œåŠ©é‡‘é¡ãƒ»ä¸Šé™</span>'+amt+'</div><div class="meta-item"><span class="meta-label">ç”³è«‹æœŸé™</span>'+ddl+'</div><div class="meta-item"><span class="meta-label">å¯¾è±¡</span>'+tgt+'</div></div><div class="card-footer"><span class="cat-tag'+(isLocal?' local':'')+'">'+esc(item.category)+'</span><span class="region-tag">ğŸ“ '+esc(item.pref||'å…¨å›½')+'</span><a class="apply-btn" href="'+esc(item.url)+'" target="_blank" rel="noopener">è©³ç´°ãƒ»ç”³è«‹ â†’</a></div></div>';
}
function esc(s){if(!s)return'';return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
loadData();
</script>
</body>
</html>
